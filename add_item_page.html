<!DOCTYPE html>
<html>
  <head>
    <title>FoodKeep</title>
    <!-- AuthUI API -->
    <script src="https://cdn.firebase.com/libs/firebaseui/3.5.2/firebaseui.js"></script>
    <link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/3.5.2/firebaseui.css" />
    
    <!-- Firebase API -->
    <script src="https://www.gstatic.com/firebasejs/5.5.8/firebase.js"></script>
    <script src="./database/setup_firebase.js"></script>
    
    <!-- JQuery API -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    
    <!-- JQueryUI API and stylesheet -->
    <link rel="stylesheet" href="./jquery-ui/jquery-ui.css">
    <script src="./jquery-ui/jquery-ui.js"></script>
    
    <!-- Local stylesheet -->
    <link rel="stylesheet" href="./add_item_style.css">
    <link rel="stylesheet" href = "./wip/home.css">
  </head>
  <body>
    <div id="header">
      <div id="title">Food Keep</div>
      <div id="nav">Home | Stats | My Items</div>
      <div id="login"><a href="#" id="login-anchor">Log In</a><a href="#" id="logout-anchor">Log Out</a></div>
    </div>
    <div id="login-dialog" title="Log In">
      <div id="firebaseui-auth-container"></div>
      <div id="loader">Loading...</div>
    </div>
    <div id="content">
      <div id="add-item-menu">
        <!-- collapsable menu -->
        <button class="dairy spoiler">Dairy</button>
        <button id="milk1" class="dairy-item choice">1% Milk</button>
        <button id="milk2" class="dairy-item choice">2% Milk</button>
        <button id="milk3" class="dairy-item choice">3% Milk</button>
        <button id="milk4" class="dairy-item choice">4% Milk</button>
        
        <button class="fruits spoiler">Fruits</button>
        <button id="apple" class="fruits-item choice">Apple</button>
        <button id="orange" class="fruits-item choice">Orange</button>
        <button id="banana" class="fruits-item choice">Banana</button>
        <button id="pear" class="fruits-item choice">Pear</button>
        
        <button class="veggies spoiler">Veggies</button>
        <button id="apple" class="veggies-item choice">Apple</button>
        <button id="orange" class="veggies-item choice">Orange</button>
        <button id="banana" class="veggies-item choice">Banana</button>
        <button id="pear" class="veggies-item choice">Pear</button>
      </div>
      <div id="item-list">
        <div id="cont-test">
          <!-- new list item entry template -->
          <div class="list-item" id="template">
            <div class="list-item-entry">
              <div class="list-item-name"></div>
              <div class="list-item-date">February 26</div>
            </div>
            <button class="remove-button">Remove</button>
          </div>
        </div>
      </div>
    </div>
    
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.3/jquery-ui.min.js"></script>
    
    <link rel="stylesheet" href="./jquery-ui/jquery-ui.css">
    <script src="./jquery-ui/jquery-ui.js"></script>
    
    <script src="./database/on_login_events.js"></script>
    <script>
      $( function() {
        $( "#login-dialog" ).dialog({
          autoOpen: false,
          draggable: false
        });
      });
    </script>
    
    <!-- jquery-ui auto button style -->
    <script>$('.choice, .spoiler, .remove-button').button();</script>
    
    <!-- collapse menu script -->
    <script>
      $('.spoiler').click(function() {
        var item = $(this).attr('class').split(' ')[0];
        $(this).parents('#add-item-menu').find('.' + item + '-item').fadeToggle();
      });
    </script>
    
    
    <!-- add item script -->
    <script>
      $(".choice").click(function() {
        var itemName = $(this).text();
        var uniqueId = 'id' + Date.now();
        console.log(uniqueId);
        var newItem = $("#template").clone().css("display", "block").attr('id', uniqueId).appendTo("#cont-test");
        $("#" + uniqueId + " .list-item-name").append(itemName);
        $("#" + uniqueId + " .remove-button").attr("id", uniqueId);
        var user = firebase.auth().currentUser;
        if (user) {
          console.log("hello " + itemName);
          firebase.database().ref("users/" + user.uid + "/list/" + uniqueId).update(
            {
              "item" : itemName,
              "actualExpiry" : "testing123"
            });
        }
        
        
        //remove button function (added for each item)
        $(".remove-button").click(function() {
          var id = $(this).attr('id');
          $("#" + id).remove();
          var user = firebase.auth().currentUser;
          firebase.database().ref("users/" + user.uid + "/list/").child(id).remove();
        });
      });
    </script>
  </body>
</html>